10 ' Refactored with MSX Basic Dignified
20 ' CHANGE GRAPH KIT
30 ' v1.3
40 ' "File requester", New file confirmation
50 ' Edit uncompressed graphics on MSX binary files on disk
60 ' Copyright (1984 - 2019) - Fred Rique (farique)
70 ' https://github.com/farique1/Change-Graph-Kit
80 '
90 ON ERROR GOTO 4560
100 ZE=0
110 SCREEN 0:COLOR 15,1,1:WIDTH 40:KEY OFF
120 DEFINT A-Z
130 DIM ZD(20,2)
140 DEF FN ZZ(X)=ABS(X MOD 16+16) MOD 16
150 ZY=1:ZX=15:ZW=2:ZV=6
160 ZU=0:ZT=0:ZS=0:ZR=0
170 ZW$="" ' leave blank to enable file request
180 ZV$=".bin" ' leave blank to all
190 IF ZV$="" THEN ZV$=".*"
200 IF ZW$<>"" THEN GOTO 820
210 ' {insert_disk}
220 CLS
230 ZE=1
240 LOCATE 14,8:PRINT "Insert disk"
250 LOCATE 12,10:PRINT "and press space"
260 A$=INKEY$:IF A$="" GOTO 260
270 CLS
280 FILES "*"+ZV$
290 PRINT:PRINT
300 PRINT ":Load":PRINT ":ARROWS choose:ENTER select:SPACE type";
310 FOR F=0 TO 24
320 ZC=0+40*F
330 IF CHR$(VPEEK(ZC))=":" THEN ZB=F-1
340 NEXT
350 X=12:Y=0
360 ZC=X+40*Y
370 GOSUB 620
380 ' {keys}
390 A$=INKEY$
400 LOCATE X,Y:PRINT "<"
410 LOCATE X,Y:PRINT " "
420 IF A$="" THEN 380
430 LOCATE X,Y:PRINT " "
440 PX=X:PY=Y
450 IF A$=CHR$(&H1C) THEN X=X+13:GOSUB 540
460 IF A$=CHR$(&H1D) THEN X=X-13:GOSUB 540
470 IF A$=CHR$(&H1E) THEN Y=Y-1:GOSUB 540
480 IF A$=CHR$(&H1F) THEN Y=Y+1:GOSUB 540
490 IF A$=CHR$(&H0D) THEN GOSUB 790
500 IF A$=" " THEN GOTO 740
510 LOCATE X,Y:PRINT "<"
520 GOSUB 620
530 GOTO 380
540 ' {move_cursor_files}
550 IF X>=39 THEN X=12
560 IF X<=0 THEN X=38
570 IF Y<=0 THEN Y=0
580 IF Y>=24 THEN Y=24
590 ZC=X+40*Y
600 IF VPEEK(ZC-12)=32 THEN X=PX:Y=PY:ZC=X+40*Y
610 RETURN
620 ' {show_content}
630 ZA=0
640 ZW$=""
650 ZU$=""
660 LOCATE 6,ZB:PRINT "            "
670 FOR F=ZC-12 TO ZC-1
680 ZU$=CHR$(VPEEK(F))
690 ZW$=ZW$+ZU$
700 LOCATE 6+ZA,ZB:PRINT ZU$
710 ZA=ZA+1
720 NEXT
730 RETURN
740 ' {type_name}
750 ZE=2
760 LOCATE 6,ZB:? "            "
770 LOCATE 6,ZB:LINE INPUT ZW$
780 IF ZW$="" THEN GOSUB 620:GOTO 380
790 ' {continue}
800 LOCATE 39,ZB+1:PRINT
810 FILES ZW$
820 ' {inicializacao}
830 CLS:SCREEN 1:WIDTH 32
840 VPOKE 6914,0:VPOKE 6918,1:VPOKE 6922,2:VPOKE 6926,3:VPOKE 6930,2 'Assign sprites
850 LOCATE 10,11:PRINT "INITIALIZING"
860 OPEN ZW$ AS #1 LEN=1
870 FIELD #1,1 AS ZZ$
880 GET #1,3:ZY$=ZZ$:GET #1,2:ZX$=ZZ$:ZQ=(ASC(ZY$)*256+ASC(ZX$))-65536!
890 GET #1,5:ZY$=ZZ$:GET #1,4:ZX$=ZZ$:ZP=(ASC(ZY$)*256+ASC(ZX$))-65536!
900 YZ=ZP-ZQ
910 YY=&H1:YX=8:YW=800:ZU=1
920 YV=YY:YU=16:YT=23:YS=8
930 GOSUB 1920
940 FOR F=0 TO 7:READ A:VPOKE 1856+F,A:NEXT
950 FOR F=0 TO 7:READ A:VPOKE 1864+F,A:NEXT
960 FOR F=0 TO 7:READ A:VPOKE 1872+F,A:NEXT
970 FOR F=0 TO 23:READ A:VPOKE 8+F,A:NEXT
980 FOR F=0 TO 7:READ A:VPOKE 1824+F,A:NEXT
990 FOR F=0 TO 7:READ A:VPOKE 128+F,A:NEXT
1000 FOR F=0 TO 7:READ A:VPOKE 248+F,A:NEXT
1010 FOR F=0 TO 31:READ A:VPOKE 14336+F,A:NEXT
1020 ' {search_screen}
1030 CLS
1040 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
1050 LOCATE 1,2:PRINT "XWWWWWWWWWWY"
1060 LOCATE 1,3:PRINT "VÄäîû®≤º∆–⁄V"
1070 LOCATE 1,4:PRINT "VÅãïü©≥Ω«—€V"
1080 LOCATE 1,5:PRINT "VÇåñ†™¥æ»“‹V"
1090 LOCATE 1,6:PRINT "VÉçó°´µø…”›V"
1100 LOCATE 1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
1110 LOCATE 1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
1120 LOCATE 1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
1130 LOCATE 1,10:PRINT "Váëõ•Øπ√Õ◊·V"
1140 LOCATE 1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
1150 LOCATE 1,12:PRINT "Vâìùß±ª≈œŸ„V"
1160 LOCATE 1,13:PRINT "ZWWWWWWWWWW["
1170 LOCATE 3,15:PRINT "Srt# End#"
1180 LOCATE 1,17:PRINT "C"
1190 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(YV)),"0")+HEX$(YV)
1200 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(YV+( YS-1))),"0")+HEX$(YV+( YS-1))
1210 LOCATE 1,19:PRINT "R"
1220 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(YY)),"0")+HEX$(YY)
1230 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(YY+799)),"0")+HEX$(YY+799)
1240 LOCATE 1,21:PRINT "G"
1250 LOCATE 3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
1260 LOCATE 8,21:PRINT STRING$(4-LEN(HEX$(YZ)),"0")+HEX$(YZ)
1270 LOCATE 13,2:PRINT "XWWWWWWWRWWWWWWWWY"
1280 ' Cm = Cursor Movement   Rm = Region Movement
1290 LOCATE 13,3:PRINT "VCm #  "+RIGHT$(STR$(YX),1)+"VEditing V"
1300 LOCATE 13,4:PRINT "VRm #"+RIGHT$(HEX$(YW),3)+"V"+LEFT$(ZW$,8)+"V"
1310 LOCATE 13,5:PRINT "ZWWWWWWWQWWWWWWWW["
1320 ' {keys_page_start}
1330 ON ZR GOTO 1410
1340 LOCATE 13,7:PRINT "VÍVMove VPVSave   "
1350 LOCATE 13,9:PRINT "VÈVStep VDVSize   "
1360 LOCATE 13,11:PRINT "VËVEdit VRVRefresh"
1370 LOCATE 13,13:PRINT "VFVFreeze/Unfreeze"
1380 LOCATE 13,15:PRINT "VEVExplode/Ovrview"
1390 LOCATE 13,17:PRINT "                  "
1400 GOTO 1480
1410 ' {keys_page_2}
1420 LOCATE 13,7:PRINT "VNVNew            "
1430 LOCATE 13,9:PRINT "VQVPrev VWVNext   "
1440 LOCATE 13,11:PRINT "VAVP 4x VSVN 4x   "
1450 LOCATE 13,13:PRINT "VZVSrtVXVMidVCVEnd"
1460 LOCATE 13,15:PRINT "V1-8VChange Colors"
1470 LOCATE 13,17:PRINT "                  "
1480 ' {keys_page_end}
1490 LOCATE 13,19:PRINT "      VVVMore Keys" ' VHVHelp
1500 LOCATE 13,21:PRINT "ABBBBBBBBBBBBBBBBC"
1510 GOSUB 2390:REM if haltScan=1 then locate 2,2:print "WWFREEZEWW"
1520 IF ZT=1 THEN LOCATE 2,13:PRINT "WOverviewW"
1530 YR=YT+(YS-2):YQ=0
1540 IF YT+(YS-2)>101 THEN YQ=8:YR=23+(YT+(YS-2))-103
1550 IF YU+YQ>95 THEN YR=200
1560 VPOKE 6912,YT-1:VPOKE 6913,YU
1570 VPOKE 6916,YR+1:VPOKE 6917,YQ+YU
1580 VPOKE 6920,167:VPOKE 6921,142*YY/YZ+105
1590 VPOKE 6928,167:VPOKE 6929,(142*YY/YZ)+105+(100800!/YZ)
1600 IF ZS=1 THEN ZS=0:GOSUB 2220
1610 ' {read_keyboard_main}
1620 A$=INKEY$
1630 IF A$="1" THEN ZY=ZY-1:GOSUB 1920
1640 IF A$="2" THEN ZY=ZY+1:GOSUB 1920
1650 IF A$="3" THEN ZX=ZX-1:GOSUB 1920
1660 IF A$="4" THEN ZX=ZX+1:GOSUB 1920
1670 IF A$="5" THEN ZW=ZW-1:GOSUB 1920
1680 IF A$="6" THEN ZW=ZW+1:GOSUB 1920
1690 IF A$="7" THEN ZV=ZV-1:GOSUB 1920
1700 IF A$="8" THEN ZV=ZV+1:GOSUB 1920
1710 IF A$=CHR$(&H1C) AND YU+8<95 THEN YU=YU+8:YV=YV+80:GOSUB 2030
1720 IF A$=CHR$(&H1D) AND YU-8>15 THEN YU=YU-8:YV=YV-80:GOSUB 2030
1730 IF A$=CHR$(&H1E) AND YT-YX>22 THEN YT=YT-YX:YV=YV-YX:GOSUB 2030
1740 IF A$=CHR$(&H1F) AND YT+YX<103 THEN YT=YT+YX:YV=YV+YX:GOSUB 2030
1750 IF A$="P" THEN SCREEN 0:WIDTH 40:CLOSE:PRINT ZW$+" closed":PRINT:PRINT:PRINT:PRINT "ENTER to open another file ";:LINE INPUT A$:RUN
1760 IF A$=" " THEN GOSUB 2430
1770 IF A$="D" THEN GOSUB 2130
1780 IF A$=CHR$(13) THEN GOTO 2480
1790 IF A$="E" THEN GOTO 3480
1800 IF A$="R" THEN ZO=0:GOSUB 2340
1810 IF A$="F" THEN ZO=0:ZU=ABS(ZU-1):IF ZU=1 THEN GOSUB 2390:ELSE:GOSUB 2340
1820 IF A$="Q" THEN ZO=YV-YY:YY=YY-YW:GOSUB 2220
1830 IF A$="W" THEN ZO=YV-YY:YY=YY+YW:GOSUB 2220
1840 IF A$="A" THEN ZO=YV-YY:YY=YY-YW*4:GOSUB 2220
1850 IF A$="S" THEN ZO=YV-YY:YY=YY+YW*4:GOSUB 2220
1860 IF A$="Z" THEN ZO=YV-YY:YY=&H1:GOSUB 2220
1870 IF A$="X" THEN ZO=YV-YY:YY=(YZ/2)-400:GOSUB 2220
1880 IF A$="C" THEN ZO=YV-YY:YY=YZ-800:GOSUB 2220
1890 IF A$="N" THEN GOSUB 4390
1900 IF A$="V" THEN ZR=ABS(ZR-1):GOTO 1320
1910 GOTO 1610
1920 ' {set_color}
1930 ZY=FN ZZ(ZY)
1940 ZX=FN ZZ(ZX)
1950 ZW=FN ZZ(ZW)
1960 ZV=FN ZZ(ZV)
1970 COLOR ZX,ZY,ZY
1980 VPOKE 8194,ZV*16+ZY:VPOKE 8195,ZV*16+ZY 'Borders character color, blocks of 8 chars
1990 VPOKE 8192,ZV*16+ZW 'Region character colors, blocks of 8 chars
2000 VPOKE 6915,ZX:VPOKE 6919,ZX:VPOKE 6923,ZX:VPOKE 6927,ZX:VPOKE 6931,ZX 'Sprite color
2010 FOR F=8208 TO 8220:VPOKE F,ZW*16+ZY:NEXT 'Scan area character colors, blocks of 8 chars
2020 RETURN
2030 ' {move_scan_sprite}
2040 YR=YT+( YS-2):YQ=0
2050 IF YT+( YS-2)>101 THEN YQ=8:YR=23+(YT+( YS-2))-103
2060 IF YU+YQ>95 THEN YR=200
2070 VPOKE 6912,YT-1:VPOKE 6913,YU
2080 VPOKE 6916,YR+1:VPOKE 6917,YU+YQ
2090 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(YV)),"0")+HEX$(YV)
2100 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(YV+( YS-1))),"0")+HEX$(YV+( YS-1))
2110 RETURN
2120 RETURN
2130 ' {change_sprite_size}
2140 IF YS=8 THEN YS=32 ELSE YS=8
2150 YR=YT+(YS-2):YQ=0
2160 IF YT+(YS-2)>101 THEN YQ=8:YR=23+(YT+(YS-2))-103
2170 IF YU+YQ>95 THEN YR=200
2180 VPOKE 6916,YR+1:VPOKE 6917,YU+YQ
2190 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(YV)),"0")+HEX$(YV)
2200 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(YV+( YS-1))),"0")+HEX$(YV+( YS-1))
2210 RETURN
2220 ' {update_memory_position}
2230 IF YY<&H1 THEN YY=&H1
2240 IF YY+800>YZ THEN YY=YZ-800
2250 YV=YY+ZO
2260 VPOKE 6920,167:VPOKE 6921,142*YY/YZ+105
2270 VPOKE 6928,167:VPOKE 6929,(142*YY/YZ)+105+(100800!/YZ)
2280 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(YV)),"0")+HEX$(YV)
2290 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(YV+7)),"0")+HEX$(YV+7)
2300 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(YY)),"0")+HEX$(YY)
2310 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(YY+799)),"0")+HEX$(YY+799)
2320 IF ZU=0 THEN 2340
2330 RETURN
2340 ' {scan}
2350 ZT=0
2360 LOCATE 2,2:PRINT "WWWSCANWWW"
2370 LOCATE 2,13:PRINT "WVÈVStopWW"
2380 FOR F=YY TO YY+799:VPOKE 1024-YY+F,0:GET #1,F:A$=ZZ$:VPOKE 1024-YY+F,ASC(A$):IF INKEY$=" " THEN 2390 ELSE NEXT
2390 ' {end_scan}
2400 IF ZU=1 THEN LOCATE 2,2:PRINT "WWFREEZEWW" ELSE LOCATE 2,2:PRINT "WWWWWWWWWW"
2410 LOCATE 2,13:PRINT "WWWWWWWWWW"
2420 RETURN
2430 ' {change_movement_step}
2440 IF YX=8 THEN YX=1 ELSE YX=8
2450 IF YW=800 THEN YW=400 ELSE YW=800
2460 LOCATE 20,3:PRINT RIGHT$(HEX$(YX),1):LOCATE 18,4:PRINT RIGHT$(HEX$(YW),3)
2470 RETURN
2480 ' {edit_screen}
2490 CLS
2500 VPOKE 6920,200:VPOKE 6928,200
2510 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
2520 LOCATE 1,2:PRINT "XWWWWWWWWWWY"
2530 LOCATE 1,3:PRINT "VÄäîû®≤º∆–⁄V"
2540 LOCATE 1,4:PRINT "VÅãïü©≥Ω«—€V"
2550 LOCATE 1,5:PRINT "VÇåñ†™¥æ»“‹V"
2560 LOCATE 1,6:PRINT "VÉçó°´µø…”›V"
2570 LOCATE 1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
2580 LOCATE 1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
2590 LOCATE 1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
2600 LOCATE 1,10:PRINT "Váëõ•Øπ√Õ◊·V"
2610 LOCATE 1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
2620 LOCATE 1,12:PRINT "Vâìùß±ª≈œŸ„V"
2630 LOCATE 1,13:PRINT "ZWWWWWWWWWW["
2640 LOCATE 3,15:PRINT "Srt# End#"
2650 LOCATE 1,17:PRINT "C"
2660 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(YV)),"0")+HEX$(YV)
2670 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(YV+( YS-1))),"0")+HEX$(YV+( YS-1))
2680 LOCATE 1,19:PRINT "R"
2690 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(YY)),"0")+HEX$(YY)
2700 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(YY+799)),"0")+HEX$(YY+799)
2710 LOCATE 1,21:PRINT "G"
2720 LOCATE 3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
2730 LOCATE 8,21:PRINT STRING$(4-LEN(HEX$(YZ)),"0")+HEX$(YZ)
2740 LOCATE 14,2:PRINT "________________"
2750 LOCATE 14,3:PRINT "________________"
2760 LOCATE 14,4:PRINT "________________"
2770 LOCATE 14,5:PRINT "________________"
2780 LOCATE 14,6:PRINT "________________"
2790 LOCATE 14,7:PRINT "________________"
2800 LOCATE 14,8:PRINT "________________"
2810 LOCATE 14,9:PRINT "________________"
2820 LOCATE 14,10:PRINT "________________"
2830 LOCATE 14,11:PRINT "________________"
2840 LOCATE 14,12:PRINT "________________"
2850 LOCATE 14,13:PRINT "________________"
2860 LOCATE 14,14:PRINT "________________"
2870 LOCATE 14,15:PRINT "________________"
2880 LOCATE 14,16:PRINT "________________"
2890 LOCATE 14,17:PRINT "________________"
2900 LOCATE 13,19:PRINT "VEVErzVRVRldVTVInv"
2910 LOCATE 13,21:PRINT "VÈVTglVPVSavVËVBck"
2920 VPOKE 6924,15:VPOKE 6925,112
2930 YP=0:YO=0:YN=0
2940 ' {fill_edit_area}
2950 YM=-1:YL=0:YK=0
2960 IF YS=8 THEN ZN=7 ELSE ZN=15
2970 ZM=YV+(YS-1) 'find formula to cap at gameLength to avoid next if
2980 IF ZM>YZ-1 THEN ZM=YZ-1
2990 FOR I=YV TO ZM
3000 YM=YM+1
3010 IF YN=0 THEN GET #1,I:A$=ZZ$:ZT$=STRING$(8-LEN(BIN$(ASC(A$))),"0")+BIN$(ASC(A$)):VPOKE 1024-YY+I,ASC(A$)
3020 IF YM>15 THEN YL=8:YK=-16
3030 FOR F=1 TO 8
3040 IF YN=2 THEN ZL=16
3050 IF YN=0 THEN IF MID$(ZT$,F,1)="0" THEN ZL=16 ELSE ZL=228
3060 IF YN=1 THEN IF VPEEK ((YL+13+F)+(YK+2+YM)*32+6144)=16 THEN ZL=228 ELSE ZL=16
3070 VPOKE (YL+13+F)+(YK+2+YM)*32+6144,ZL
3080 NEXT
3090 NEXT
3100 ' {read_keyboard_edit}
3110 A$=INKEY$
3120 IF A$=CHR$(&H1C) AND YP<ZN THEN YP=YP+1:GOSUB 3230
3130 IF A$=CHR$(&H1D) AND YP>0 THEN YP=YP-1:GOSUB 3230
3140 IF A$=CHR$(&H1E) AND YO>0 THEN YO=YO-1:GOSUB 3230
3150 IF A$=CHR$(&H1F) AND YO<ZN THEN YO=YO+1:GOSUB 3230
3160 IF A$="E" THEN YN=2:GOTO 2940
3170 IF A$="R" THEN YN=0:GOTO 2940
3180 IF A$="T" THEN YN=1:GOTO 2940
3190 IF A$=" " THEN GOSUB 3260
3200 IF A$="P" THEN GOSUB 3310
3210 IF A$=CHR$(13) THEN VPOKE 6924,200:GOTO 1020
3220 GOTO 3100
3230 ' {move_cursor}
3240 VPOKE 6924,15+(YO*8):VPOKE 6925,112+(YP*8)
3250 RETURN
3260 ' {change_bit}
3270 ZL=VPEEK ((YP+14)+(YO+2)*32+6144)
3280 ZL=(228+16)-ZL
3290 VPOKE (YP+14)+(YO+2)*32+6144,ZL
3300 RETURN
3310 ' {save_drawing}
3320 YM=-1:YL=0:YK=0
3330 ZM=YV+(YS-1) 'find formula to cap at gameLength to avoid next if
3340 IF ZM>YZ-1 THEN ZM=YZ-1
3350 FOR I=YV TO ZM
3360 YM=YM+1
3370 IF YM>15 THEN YL=8:YK=-16
3380 YJ=128:YI=0
3390 FOR F=1 TO 8
3400 IF VPEEK ((YL+13+F)+(YK+2+YM)*32+6144)=16 THEN G$="0" ELSE G$="1"
3410 YI=VAL(G$)*YJ+YI:YJ=YJ/2
3420 NEXT
3430 A$=CHR$(YI)
3440 LSET ZZ$=A$:PUT #1,I
3450 VPOKE 1024-YY+I,YI
3460 NEXT
3470 RETURN
3480 ' {explode_screen}
3490 CLS
3500 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
3510 LOCATE 1,2:PRINT "XWWWWWWWWWWWWWWWWWWWY"
3520 LOCATE 1,3:PRINT "VÄ ä î û ® ≤ º ∆ – ⁄V"
3530 LOCATE 1,4:PRINT "V                   V"
3540 LOCATE 1,5:PRINT "VÅ ã ï ü © ≥ Ω « — €V"
3550 LOCATE 1,6:PRINT "V                   V"
3560 LOCATE 1,7:PRINT "VÇ å ñ † ™ ¥ æ » “ ‹V"
3570 LOCATE 1,8:PRINT "V                   V"
3580 LOCATE 1,9:PRINT "VÉ ç ó ° ´ µ ø … ” ›V"
3590 LOCATE 1,10:PRINT "V                   V"
3600 LOCATE 1,11:PRINT "VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
3610 LOCATE 1,12:PRINT "V                   V"
3620 LOCATE 1,13:PRINT "VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
3630 LOCATE 1,14:PRINT "V                   V"
3640 LOCATE 1,15:PRINT "VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
3650 LOCATE 1,16:PRINT "V                   V"
3660 LOCATE 1,17:PRINT "Vá ë õ • Ø π √ Õ ◊ ·V"
3670 LOCATE 1,18:PRINT "V                   V"
3680 LOCATE 1,19:PRINT "Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
3690 LOCATE 1,20:PRINT "V                   V"
3700 LOCATE 1,21:PRINT "Vâ ì ù ß ± ª ≈ œ Ÿ „V"
3710 LOCATE 1,22:PRINT "ZWWWWWWWWWWWWWWWWWWW["
3720 LOCATE 23,03:PRINT "VOV Ovrw"
3730 LOCATE 23,21:PRINT "VEV Back"
3740 VPOKE 6912,200:VPOKE 6916,200
3750 VPOKE 6920,200:VPOKE 6928,200
3760 IF ZT=1 THEN GOSUB 4110
3770 ' {move_overview_sprite}
3780 IF ZT=0 THEN 3840
3790 VPOKE 6912,(ZJ+1)*16+6:VPOKE 6913,(ZK+1)*16
3800 VPOKE 6916,(ZJ+1)*16+14:VPOKE 6917,(ZK+1)*16
3810 ZF=(ZJ*ZH)+(ZK*(ZH*10))
3820 LOCATE 27,13:PRINT STRING$(4-LEN(HEX$(ZF)),"0")+HEX$(ZF)
3830 LOCATE 27,15:PRINT STRING$(4-LEN(HEX$(ZF+799)),"0")+HEX$(ZF+799)
3840 ' {explode_keys}
3850 A$=INKEY$
3860 IF A$="O" THEN GOSUB 3940
3870 IF A$=CHR$(&H1C) AND ZK<9 THEN ZK=ZK+1:GOSUB 3770
3880 IF A$=CHR$(&H1D) AND ZK>0 THEN ZK=ZK-1:GOSUB 3770
3890 IF A$=CHR$(&H1F) AND ZJ<9 THEN ZJ=ZJ+1:GOSUB 3770
3900 IF A$=CHR$(&H1E) AND ZJ>0 THEN ZJ=ZJ-1:GOSUB 3770
3910 IF A$=CHR$(13) AND ZT=1 THEN YY=(ZJ*ZH)+(ZK*(ZH*10)):ZS=1:YV=YY:YU=16:YT=23:IF YY+799>YZ THEN YY=YZ-799:YU=16:YT=23:YV=YY:GOTO 1020 ELSE GOTO 1020
3920 IF A$="E" THEN GOTO 1020
3930 GOTO 3840
3940 ' {overview}
3950 ZI=0
3960 ZT=1
3970 ZH=(YZ/100)
3980 ZG=(9*ZH)+(9*(ZH*10))+8
3990 LOCATE 2,2:PRINT "WWWWWWWSCANWWWWWWWW"
4000 LOCATE 2,22:PRINT "WWWWWVÈVStopWWWWWWW"
4010 FOR F=1 TO ZG STEP ZH
4020 FOR I=F TO F+7
4030 VPOKE 1024+ZI,0
4040 GET #1,I
4050 A$=ZZ$
4060 VPOKE 1024+ZI,ASC(A$)
4070 IF INKEY$=" " THEN 4110
4080 ZI=ZI+1
4090 NEXT
4100 NEXT
4110 ' {end_overview}
4120 VPOKE 6912,(ZJ+1)*16+6:VPOKE 6913,(ZK+1)*16
4130 VPOKE 6916,(ZJ+1)*16+14:VPOKE 6917,(ZK+1)*16
4140 LOCATE 23,05:PRINT "VÍV Move"
4150 LOCATE 23,07:PRINT "VËV Go"
4160 LOCATE 23,11:PRINT "Region"
4170 ZF=(ZJ*ZH)+(ZK*(ZH*10))
4180 LOCATE 23,13:PRINT "St# "+STRING$(4-LEN(HEX$(ZF)),"0")+HEX$(ZF)
4190 LOCATE 23,15:PRINT "Ed# "+STRING$(4-LEN(HEX$(ZF+799)),"0")+HEX$(ZF+799)
4200 LOCATE 02,2:PRINT "WWWWWWWWWWWWWWWWWWW"
4210 LOCATE 2,22:PRINT "WWWWWWWWWWWWWWWWWWW"
4220 RETURN
4230 END
4240 ' {character_shapes}
4250 DATA 4,4,36,100,252,96,32,0
4260 DATA 0,0,219,154,82,211,0,0
4270 DATA 231,195,165,24,24,165,195,231
4280 DATA 255,128,128,128,128,128,128,255
4290 DATA 255,0,0,0,0,0,0,255
4300 DATA 255,1,1,1,1,1,1,255
4310 DATA 0,126,126,126,126,126,126,0
4320 DATA 255,129,129,129,129,129,129,255
4330 DATA 255,255,255,255,255,255,255,255
4340 ' {sprite_shapes}
4350 DATA 255,129,0,0,0,0,0,0
4360 DATA 129,255,0,0,0,0,0,0
4370 DATA 0,128,128,128,128,128,128,0
4380 DATA 255,129,129,129,129,129,129,255
4390 ' {new_file}
4400 FOR F=5 TO 25
4410 ZD(F-5,0)=VPEEK(&H1800+F+32*10)
4420 ZD(F-5,1)=VPEEK(&H1800+F+32*11)
4430 ZD(F-5,2)=VPEEK(&H1800+F+32*12)
4440 NEXT
4450 LOCATE 5,10:PRINT "XWWWWWWWWWWWWWWWWWWWY"
4460 LOCATE 5,11:PRINT "VAre you sure? (Y/N)V"
4470 LOCATE 5,12:PRINT "ZWWWWWWWWWWWWWWWWWWW[
4480 A$=INKEY$:IF A$<>"Y" AND A$<>"N" THEN 4480
4490 IF A$="Y" THEN RUN
4500 FOR F=5 TO 25
4510 VPOKE &H1800+F+32*10,ZD(F-5,0)
4520 VPOKE &H1800+F+32*11,ZD(F-5,1)
4530 VPOKE &H1800+F+32*12,ZD(F-5,2)
4540 NEXT
4550 RETURN
4560 ' {error}
4570 IF (ERR=53 AND ZE=1) OR ERR=70 THEN GOTO 4620
4580 IF ERR=53 AND ZE=2 THEN GOTO 4700
4590 IF ERR=56 AND ZE=2 THEN ZE=3:GOTO 4700
4600 PRINT ERR;"at line ";ERL
4610 STOP
4620 ' {file_not_found}
4630 PRINT:PRINT "No files found"
4640 PRINT:PRINT "Press space to restart"
4650 A$=INKEY$:IF A$=" " THEN PRINT ELSE 4650
4660 ZE=0
4670 CLS
4680 RESUME 210
4690 ON ERROR GOTO 0
4700 ' {input_past_end}
4710 PRINT:PRINT
4720 IF ZE=2 THEN:PRINT ZW$;" not found" ELSE PRINT "Invalid name"
4730 PRINT:PRINT "Press space to restart"
4740 A$=INKEY$:IF A$=" " THEN PRINT ELSE 4740
4750 ZE=0
4760 RESUME 210
4770 ON ERROR GOTO 0
4780 ' {functions_not_used}
4790 ' {create_character_block}
4800 C=127
4810 FOR X=2 TO 11
4820 FOR Y=3 TO 12
4830 C=C+1:LOCATE X,Y:PRINT:PRINT CHR$(C)
4840 NEXT
4850 NEXT
4860 END
4870 ' {character_map}
4880 FOR I=0 TO 255
4890 X=I MOD 32:Y=I\32
4900 C=I
4910 IF C<32 OR C=127 THEN C=32
4920 LOCATE X,Y:PRINT CHR$(C)
4930 LOCATE X,Y+10:PRINT CHR$(1)+CHR$(C)
4940 NEXT
4950 END
