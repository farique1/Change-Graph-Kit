10 ' Refactored with MSX Basic Dignified
20 ' CHANGE GRAPH KIT
30 ' v1.2.4
40 ' Edit uncompressed graphics on MSX binary files on disk
50 ' Copyright (1984 - 2019) - Fred Rique (farique)
60 ' https://github.com/farique1/Change-Graph-Kit
70 '
80 SCREEN 0:COLOR 15,1,1:WIDTH 40:KEY OFF
90 DEFINT A-Z
100 DEF FN CO (X)=ABS(X MOD 16+16) MOD 16 ' CICLE COLOR 0 - 15
110 C1=1:C2=15:C3=2:C4=6 ' COLORS
120 HS = 0:OV = 0:GO = 0:KP = 0 ' TOGGLE REFRESH, OVERVIEW, GO OVERVIEW POS, KEYS DISP PAGE
130 WX=0:WY=0 ' OVERVIEW CURESOS POSITION
140 LOCATE12,8:PRINT "Insert game disk"
150 LOCATE11,10:PRINT "and press any key."
160 A$ = INKEY$:IF A$ = "" GOTO 160
170 CLS
180 GN$="" ' COMMENT TO ENABLE FILE REQUEST
190 IF GN$<>"" THEN GOTO 230
200 PRINT "Pick a Game":PRINT "without extension"
210 PRINT:PRINT:PRINT:FILES "*.bin"
220 PRINT:PRINT:PRINT:LINE INPUT "> ";GN$
230 ' {inicializacao}
240 CLS:SCREEN 1:WIDTH 32
250 VPOKE 6914,0:VPOKE 6918,1:VPOKE 6922,2:VPOKE 6926,3:VPOKE 6930,2 'ASSIGN SPRITES
260 LOCATE10,11:PRINT "INITIALIZING"
270 OPEN GN$+".bin" AS #1 LEN=1
280 FIELD #1,1 AS F$
290 GET#1,3:A$=F$:GET#1,2:B$=F$:GS=(ASC(A$)*256+ASC(B$))-65536!
300 GET#1,5:A$=F$:GET#1,4:B$=F$:GE=(ASC(A$)*256+ASC(B$))-65536!
310 GL=GE-GS
320 SI=&H1:MS=8:MR=800:HS=1
330 PS=SI:SX=16:SY=23:SS=8
340 CX=0:CY=0:TE=0
350 GOSUB 1340
360 FOR F=0 TO 7:READ A:VPOKE 1856+F,A:NEXT
370 FOR F=0 TO 7:READ A:VPOKE 1864+F,A:NEXT
380 FOR F=0 TO 7:READ A:VPOKE 1872+F,A:NEXT
390 FOR F=8 TO 31:READ A:VPOKE F,A:NEXT
400 FOR F=1824 TO 1831:READ A:VPOKE F,A:NEXT
410 FOR F=128 TO 135:READ A:VPOKE F,A:NEXT
420 FOR F=248 TO 255:READ A:VPOKE F,A:NEXT
430 FOR F=0 TO 31:READ A:VPOKE 14336+F,A:NEXT
440 ' {search_screen}
450 CLS
460 LOCATE 0,0:PRINT"        CHANGE GRAPH KIT        "
470 LOCATE 1,2:PRINT"XWWWWWWWWWWY"
480 LOCATE 1,3:PRINT"VÄäîû®≤º∆–⁄V"
490 LOCATE 1,4:PRINT"VÅãïü©≥Ω«—€V"
500 LOCATE 1,5:PRINT"VÇåñ†™¥æ»“‹V"
510 LOCATE 1,6:PRINT"VÉçó°´µø…”›V"
520 LOCATE 1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
530 LOCATE 1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
540 LOCATE 1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
550 LOCATE 1,10:PRINT"Váëõ•Øπ√Õ◊·V"
560 LOCATE 1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
570 LOCATE 1,12:PRINT"Vâìùß±ª≈œŸ„V"
580 LOCATE 1,13:PRINT"ZWWWWWWWWWW["
590 LOCATE 3,15:PRINT"Srt# End#"
600 LOCATE 1,17:PRINT"C"
610 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
620 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
630 LOCATE 1,19:PRINT"R"
640 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
650 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
660 LOCATE 1,21:PRINT"G"
670 LOCATE 3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
680 LOCATE 8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
690 LOCATE 13,2:PRINT"XWWWWWWWRWWWWWWWWY"
700 ' Cm = Cursor Movement   Rm = Region Movement
710 LOCATE 13,3:PRINT"VCm #  "+RIGHT$(STR$(MS),1)+"VEditing V"
720 LOCATE 13,4:PRINT"VRm #"+RIGHT$(HEX$(MR),3)+"V"+GN$+STRING$(8-LEN(GN$)," ")+"V"
730 LOCATE 13,5:PRINT"ZWWWWWWWQWWWWWWWW["
740 ' {keys_page_start}
750 ON KP GOTO 830
760 LOCATE 13,7:PRINT"VÍVMove VPVSave   "
770 LOCATE 13,9:PRINT"VÈVStep VDVSize   "
780 LOCATE 13,11:PRINT"VËVEdit VRVRefresh"
790 LOCATE 13,13:PRINT"VFVFreeze/Unfreeze"
800 LOCATE 13,15:PRINT"VEVExplode/Ovrview"
810 LOCATE 13,17:PRINT"                  "
820 GOTO 900
830 ' {keys_page_2}
840 LOCATE 13,7:PRINT"VNVNew            "
850 LOCATE 13,9:PRINT"VQVPrev VWVNext   "
860 LOCATE 13,11:PRINT"VAVP 4x VSVN 4x   "
870 LOCATE 13,13:PRINT"VZVSrtVXVMidVCVEnd"
880 LOCATE 13,15:PRINT"V1-8VChange Colors"
890 LOCATE 13,17:PRINT"                  "
900 ' {keys_page_end}
910 LOCATE 13,19:PRINT"      VVVMore Keys" ' VHVHELP
920 LOCATE 13,21:PRINT"ABBBBBBBBBBBBBBBBC"
930 GOSUB 1820:REM if hs=1 then locate 2,2:print"WWFREEZEWW"
940 IF OV = 1 THEN LOCATE 2,13:PRINT"WOverviewW"
950 AY=SY+(SS-2):AX=0
960 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
970 IF SX+AX > 95 THEN AY=200
980 VPOKE 6912,SY-1:VPOKE 6913,SX
990 VPOKE 6916,AY+1:VPOKE 6917,AX+SX
1000 VPOKE 6920,167:VPOKE 6921,142*SI/GL+105
1010 VPOKE 6928,167:VPOKE 6929,(142*SI/GL)+105+(100800!/GL)
1020 IF GO = 1 THEN GO = 0:GOSUB 1640
1030 ' {read_keyboard_main}
1040 A$ = INKEY$
1050 IF A$ = "1" THEN C1=C1-1:GOSUB 1340
1060 IF A$ = "2" THEN C1=C1+1:GOSUB 1340
1070 IF A$ = "3" THEN C2=C2-1:GOSUB 1340
1080 IF A$ = "4" THEN C2=C2+1:GOSUB 1340
1090 IF A$ = "5" THEN C3=C3-1:GOSUB 1340
1100 IF A$ = "6" THEN C3=C3+1:GOSUB 1340
1110 IF A$ = "7" THEN C4=C4-1:GOSUB 1340
1120 IF A$ = "8" THEN C4=C4+1:GOSUB 1340
1130 IF A$ = CHR$(&H1C) AND SX+8 < 95 THEN SX=SX+8:PS=PS+80:GOSUB 1450
1140 IF A$ = CHR$(&H1D) AND SX-8 > 15 THEN SX=SX-8:PS=PS-80:GOSUB 1450
1150 IF A$ = CHR$(&H1E) AND SY-MS > 22 THEN SY=SY-MS:PS=PS-MS:GOSUB 1450
1160 IF A$ = CHR$(&H1F) AND SY+MS < 103 THEN SY=SY+MS:PS=PS+MS:GOSUB 1450
1170 IF A$ = "P" THEN SCREEN 0:WIDTH 40:CLOSE:PRINT GN$+" closed":PRINT:PRINT:PRINT:PRINT "ENTER to open another file ";:LINE INPUT A$:RUN
1180 IF A$ = " " THEN GOSUB 1860
1190 IF A$ = "D" THEN GOSUB 1550
1200 IF A$ = CHR$(13) THEN GOTO 1910
1210 IF A$ = "E" THEN GOTO 2930
1220 IF A$ = "R" THEN DP = 0:GOSUB 1770
1230 IF A$ = "F" THEN DP = 0:HS = ABS(HS-1):IF HS = 1 THEN GOSUB 1820:ELSE:GOSUB 1770
1240 IF A$ = "Q" THEN DP=PS-SI:SI=SI-MR:GOSUB 1640
1250 IF A$ = "W" THEN DP=PS-SI:SI=SI+MR:GOSUB 1640
1260 IF A$ = "A" THEN DP=PS-SI:SI=SI-MR*4:GOSUB 1640
1270 IF A$ = "S" THEN DP=PS-SI:SI=SI+MR*4:GOSUB 1640
1280 IF A$ = "Z" THEN DP=PS-SI:SI=&H1:GOSUB 1640
1290 IF A$ = "X" THEN DP=PS-SI:SI=(GL/2)-400:GOSUB 1640
1300 IF A$ = "C" THEN DP=PS-SI:SI=GL-800:GOSUB 1640
1310 IF A$ = "N" THEN RUN
1320 IF A$ = "V" THEN KP = ABS(KP-1):GOTO 740
1330 GOTO 1030
1340 ' {set_color}
1350 C1 = FN CO(C1)
1360 C2 = FN CO(C2)
1370 C3 = FN CO(C3)
1380 C4 = FN CO(C4)
1390 COLOR C2,C1,C1
1400 VPOKE 8194,C4*16+C1:VPOKE 8195,C4*16+C1 'BORDERS CHARACTER COLOR, BLOCKS OF 8 CHARS
1410 VPOKE 8192,C4*16+C3 ' REGION CHARACTER COLORS, BLOCKS OF 8 CHARS
1420 VPOKE 6915,C2:VPOKE 6919,C2:VPOKE 6923,C2:VPOKE 6927,C2:VPOKE 6931,C2 'SPRITE COLOR
1430 FOR F=8208 TO 8220:VPOKE F,C3*16+C1:NEXT 'SCAN AREA CHARACTER COLORS, BLOCKS OF 8 CHARS
1440 RETURN
1450 ' {move_scan_sprite}
1460 AY=SY+(SS-2):AX=0
1470 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1480 IF SX+AX > 95 THEN AY=200
1490 VPOKE 6912,SY-1:VPOKE 6913,SX
1500 VPOKE 6916,AY+1:VPOKE 6917,SX+AX
1510 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1520 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1))
1530 RETURN
1540 RETURN
1550 ' {change_sprite_size}
1560 IF SS = 8 THEN SS=32 ELSE SS=8
1570 AY=SY+(SS-2):AX=0
1580 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1590 IF SX+AX > 95 THEN AY=200
1600 VPOKE 6916,AY+1:VPOKE 6917,SX+AX
1610 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1620 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1))
1630 RETURN
1640 ' {update_memory_position}
1650 IF SI < &H1 THEN SI=&H1
1660 IF SI+800 > GL THEN SI=GL-800
1670 PS=SI+DP
1680 VPOKE 6920,167:VPOKE 6921,142*SI/GL+105
1690 VPOKE 6928,167:VPOKE 6929,(142*SI/GL)+105+(100800!/GL)
1700 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1710 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
1720 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
1730 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
1740 'for f = si to si+799:vpoke 1024-si+f,peek(f) :next
1750 IF HS=0 THEN 1770
1760 RETURN
1770 ' {scan}
1780 OV = 0
1790 LOCATE2,2:PRINT "WWWSCANWWW"
1800 LOCATE2,13:PRINT "WVÈVStopWW"
1810 FOR F=SI TO SI+799:VPOKE 1024-SI+F,0:GET #1,F:A$=F$:VPOKE 1024-SI+F,ASC(A$):IF INKEY$=" " THEN 1820 ELSE NEXT
1820 ' {end_scan}
1830 IF HS = 1 THEN LOCATE2,2:PRINT "WWFREEZEWW" ELSE LOCATE2,2:PRINT "WWWWWWWWWW"
1840 LOCATE2,13:PRINT "WWWWWWWWWW"
1850 RETURN
1860 ' {change_movement_step}
1870 IF MS=8 THEN MS=1 ELSE MS=8
1880 IF MR=800 THEN MR=400 ELSE MR=800
1890 LOCATE20,3:PRINT RIGHT$(HEX$(MS),1):LOCATE18,4:PRINT RIGHT$(HEX$(MR),3)
1900 RETURN
1910 ' {edit_screen}
1920 CLS
1930 VPOKE 6920,200:VPOKE 6928,200
1940 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
1950 LOCATE1,2:PRINT"XWWWWWWWWWWY"
1960 LOCATE1,3:PRINT"VÄäîû®≤º∆–⁄V"
1970 LOCATE1,4:PRINT"VÅãïü©≥Ω«—€V"
1980 LOCATE1,5:PRINT"VÇåñ†™¥æ»“‹V"
1990 LOCATE1,6:PRINT"VÉçó°´µø…”›V"
2000 LOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
2010 LOCATE1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
2020 LOCATE1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
2030 LOCATE1,10:PRINT"Váëõ•Øπ√Õ◊·V"
2040 LOCATE1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
2050 LOCATE1,12:PRINT"Vâìùß±ª≈œŸ„V"
2060 LOCATE1,13:PRINT"ZWWWWWWWWWW["
2070 LOCATE3,15:PRINT "Srt# End#"
2080 LOCATE1,17:PRINT "S"
2090 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
2100 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
2110 LOCATE1,19:PRINT "R"
2120 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
2130 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
2140 LOCATE1,21:PRINT "G"
2150 LOCATE3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
2160 LOCATE8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
2170 LOCATE14,2:PRINT "________________"
2180 LOCATE14,3:PRINT "________________"
2190 LOCATE14,4:PRINT "________________"
2200 LOCATE14,5:PRINT "________________"
2210 LOCATE14,6:PRINT "________________"
2220 LOCATE14,7:PRINT "________________"
2230 LOCATE14,8:PRINT "________________"
2240 LOCATE14,9:PRINT "________________"
2250 LOCATE14,10:PRINT "________________"
2260 LOCATE14,11:PRINT "________________"
2270 LOCATE14,12:PRINT "________________"
2280 LOCATE14,13:PRINT "________________"
2290 LOCATE14,14:PRINT "________________"
2300 LOCATE14,15:PRINT "________________"
2310 LOCATE14,16:PRINT "________________"
2320 LOCATE14,17:PRINT "________________"
2330 LOCATE13,19:PRINT"VEVErzVRVRldVTVInv"
2340 LOCATE13,21:PRINT"VÈVTglVPVSavVËVBck"
2350 CX = 0:CY = 0:TE = 0
2360 VPOKE 6924,15:VPOKE 6925,112
2370 ' {fill_edit_area}
2380 C=-1:OX=0:OY=0
2390 IF SS=8 THEN CL=7 ELSE CL=15
2400 FP = PS+(SS-1)
2410 IF FP > GL-1 THEN FP = GL-1 ' IF FINAL POSITION ADDRESS BIGGER THEN GAME ENDING, TRIM
2420 FOR I=PS TO FP
2430 C=C+1
2440 IF TE=0 THEN GET #1,I:A$=F$:P$=BIN$(ASC(A$)):A=LEN(P$):Z=8-A:C$=STRING$(Z,"0"):B$=C$+P$:VPOKE 1024-SI+I,ASC(A$)
2450 IF C>15 THEN OX=8:OY=-16
2460 FOR F=1 TO 8
2470 IF TE=0 THEN IF MID$(B$,F,1)="0" THEN G=16 ELSE G=228
2480 IF TE=1 THEN IF VPEEK((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G=228 ELSE G=16
2490 IF TE=2 THEN G=16
2500 VPOKE(OX+13+F)+(OY+2+C)*32+6144,G
2510 NEXT
2520 NEXT
2530 ' {read_keyboard_edit}
2540 A$ = INKEY$
2550 IF A$ = CHR$(&H1C) AND CX < CL THEN CX = CX+1:GOSUB 2660
2560 IF A$ = CHR$(&H1D) AND CX > 0 THEN CX = CX-1:GOSUB 2660
2570 IF A$ = CHR$(&H1E) AND CY > 0 THEN CY = CY-1:GOSUB 2660
2580 IF A$ = CHR$(&H1F) AND CY < CL THEN CY = CY+1:GOSUB 2660
2590 IF A$ = "E" THEN TE = 2:GOTO 2370
2600 IF A$ = "R" THEN TE = 0:GOTO 2370
2610 IF A$ = "T" THEN TE = 1:GOTO 2370
2620 IF A$ = " " THEN GOSUB 2690
2630 IF A$ = "P" THEN GOSUB 2740
2640 IF A$ = CHR$(13) THEN VPOKE 6924,200:GOTO 440
2650 GOTO 2530
2660 ' {move_cursor}
2670 VPOKE 6924,15+(CY*8):VPOKE 6925,112+(CX*8)
2680 RETURN
2690 ' {change_bit}
2700 G = VPEEK((CX+14)+(CY+2)*32+6144)
2710 IF G = 16 THEN G = 228 ELSE IF G = 228 THEN G = 16
2720 VPOKE(CX+14)+(CY+2)*32+6144,G
2730 RETURN
2740 ' {save_drawing}
2750 C=-1:OX=0:OY=0
2760 FP = PS+(SS-1)
2770 IF FP > GL-1 THEN FP = GL-1 ' IF FINAL POSITION ADDRESS BIGGER THEN GAME ENDING, TRIM
2780 FOR I=PS TO FP
2790 C=C+1
2800 'get #1,i :a$ = f$ :p$ = bin$(asc(a$)):a = len(p$):z = 8-a :c$ = string$(z,"0") :b$ = c$+p$
2810 IF C>15 THEN OX=8:OY=-16
2820 B$="":M=128:N=0
2830 FOR F=1 TO 8
2840 IF VPEEK ((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G$ = "0" ELSE G$ = "1"
2850 B$=B$+G$
2860 N=VAL(G$)*M+N:M=M/2
2870 NEXT
2880 A$=CHR$(N)
2890 LSET F$=A$:PUT #1,I
2900 VPOKE 1024-SI+I,N
2910 NEXT
2920 RETURN
2930 ' {explode_screen}
2940 CLS
2950 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
2960 LOCATE1,2:PRINT "XWWWWWWWWWWWWWWWWWWWY"
2970 LOCATE1,3:PRINT "VÄ ä î û ® ≤ º ∆ – ⁄V"
2980 LOCATE1,4:PRINT "V                   V"
2990 LOCATE1,5:PRINT "VÅ ã ï ü © ≥ Ω « — €V"
3000 LOCATE1,6:PRINT "V                   V"
3010 LOCATE1,7:PRINT "VÇ å ñ † ™ ¥ æ » “ ‹V"
3020 LOCATE1,8:PRINT "V                   V"
3030 LOCATE1,9:PRINT "VÉ ç ó ° ´ µ ø … ” ›V"
3040 LOCATE1,10:PRINT "V                   V"
3050 LOCATE1,11:PRINT "VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
3060 LOCATE1,12:PRINT "V                   V"
3070 LOCATE1,13:PRINT "VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
3080 LOCATE1,14:PRINT "V                   V"
3090 LOCATE1,15:PRINT "VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
3100 LOCATE1,16:PRINT "V                   V"
3110 LOCATE1,17:PRINT "Vá ë õ • Ø π √ Õ ◊ ·V"
3120 LOCATE1,18:PRINT "V                   V"
3130 LOCATE1,19:PRINT "Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
3140 LOCATE1,20:PRINT "V                   V"
3150 LOCATE1,21:PRINT "Vâ ì ù ß ± ª ≈ œ Ÿ „V"
3160 LOCATE1,22:PRINT "ZWWWWWWWWWWWWWWWWWWW["
3170 LOCATE23,03:PRINT "VOV Ovrw"
3180 LOCATE23,21:PRINT "VEV Back"
3190 VPOKE 6912,200:VPOKE 6916,200
3200 VPOKE 6920,200:VPOKE 6928,200
3210 IF OV = 1 THEN GOSUB 3560
3220 ' {move_ovrw_sprite}
3230 IF OV = 0 THEN 3290
3240 VPOKE 6912,(OY+1)*16+6:VPOKE 6913,(OX+1)*16
3250 VPOKE 6916,(OY+1)*16+14:VPOKE 6917,(OX+1)*16
3260 SI=(OY*ST)+(OX*(ST*10))
3270 LOCATE27,13:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
3280 LOCATE27,15:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
3290 ' {explode_keys}
3300 A$=INKEY$
3310 IF A$ = "O" THEN GOSUB 3390
3320 IF A$ = CHR$(&H1C) AND OX < 9 THEN OX=OX+1:GOSUB 3220
3330 IF A$ = CHR$(&H1D) AND OX > 0 THEN OX=OX-1:GOSUB 3220
3340 IF A$ = CHR$(&H1F) AND OY < 9 THEN OY=OY+1:GOSUB 3220
3350 IF A$ = CHR$(&H1E) AND OY > 0 THEN OY=OY-1:GOSUB 3220
3360 IF A$ = CHR$(13) AND OV = 1 THEN SI=(OY*ST)+(OX*(ST*10)):GO = 1:IF SI + 799 > GL THEN SI = GL - 799:GOTO 440:ELSE GOTO 440
3370 IF A$ = "E" THEN GOTO 440
3380 GOTO 3290
3390 ' {overview}
3400 A = 0
3410 OV = 1
3420 ST = (GL/100):' slice game in 100 parts (to display first 8 bytes from each)
3430 OL = (9*ST)+(9*(ST*10)) + 8 ' LAS OVERVIWE BLOCK ADDRESS
3440 LOCATE2,2:PRINT "WWWWWWWSCANWWWWWWWW"
3450 LOCATE2,22:PRINT "WWWWWVÈVStopWWWWWWW"
3460 FOR F=1 TO OL STEP ST
3470 FOR G = F TO F+7
3480 VPOKE 1024+A,0
3490 GET #1,G
3500 A$=F$
3510 VPOKE 1024+A,ASC(A$)
3520 IF INKEY$=" " THEN 3560
3530 A = A + 1
3540 NEXT
3550 NEXT
3560 ' {end_overview}
3570 VPOKE 6912,(OY+1)*16+6:VPOKE 6913,(OX+1)*16
3580 VPOKE 6916,(OY+1)*16+14:VPOKE 6917,(OX+1)*16
3590 LOCATE23,05:PRINT "VÍV Move"
3600 LOCATE23,07:PRINT "VËV Go"
3610 LOCATE23,11:PRINT "Region"
3620 SI=(OY*ST)+(OX*(ST*10))
3630 LOCATE23,13:PRINT "St# " + STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
3640 LOCATE23,15:PRINT "Ed# " + STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
3650 LOCATE2,2:PRINT "WWWWWWWWWWWWWWWWWWW"
3660 LOCATE2,22:PRINT "WWWWWWWWWWWWWWWWWWW"
3670 RETURN
3680 END
3690 ' {character_shapes}
3700 DATA 4,4,36,100,252,96,32,0
3710 DATA 0,0,219,154,82,211,0,0
3720 DATA 231,195,165,24,24,165,195,231
3730 DATA 255,128,128,128,128,128,128,255
3740 DATA 255,0,0,0,0,0,0,255
3750 DATA 255,1,1,1,1,1,1,255
3760 DATA 0,126,126,126,126,126,126,0
3770 DATA 255,129,129,129,129,129,129,255
3780 DATA 255,255,255,255,255,255,255,255
3790 ' {sprite_shapes}
3800 DATA 255,129,0,0,0,0,0,0
3810 DATA 129,255,0,0,0,0,0,0
3820 DATA 0,128,128,128,128,128,128,0
3830 DATA 255,129,129,129,129,129,129,255
3840 ' {functions_not_used}
3850 ' {cria_bloco_de_caracteres}
3860 C=127
3870 FOR X=2 TO 11
3880 FOR Y=3 TO 12
3890 C=C+1:LOCATEX,Y:PRINT CHR$(C)
3900 NEXT
3910 NEXT
3920 END
3930 ' {mapa_de_caracteres}
3940 FOR I=0 TO 255
3950 X=I MOD 32:Y=I\32
3960 C=I
3970 IF C<32 OR C=127 THEN C=32
3980 LOCATEX,Y:PRINT CHR$(C)
3990 LOCATEX,Y+10:PRINT CHR$(1)+CHR$(C)
4000 NEXT
4010 END
